import{_ as h,W as b,a as m,f as g,r as f,o as n,c as r,b as s,h as x,i as d,v as u,t as l,e as y,F as w,j as v,g as _}from"./index-34d007ee.js";const k={name:"ClienteMediciones",components:{WeightChart:b},data(){return{peso:null,altura:null,cintura:null,saving:!1,msg:"",mediciones:[],loadingList:!1}},methods:{async submitMedicion(){this.saving=!0,this.msg="";try{const o=await m.post("/api/mediciones",{peso:this.peso,altura:this.altura,cintura:this.cintura}),e=await o.json();if(!o.ok)throw new Error(e.error||"Error al guardar");this.msg="Medición guardada con id "+e.id,this.peso=this.altura=this.cintura=null,this.fetchMediciones()}catch(o){this.msg=o.message}finally{this.saving=!1}},async fetchMediciones(){this.loadingList=!0,this.mediciones=[];try{const o=g.getSession().user_id,e=await m.get(`/api/mediciones/${o}`),a=await e.json();if(!e.ok)throw new Error(a.error||"Error al obtener mediciones");this.mediciones=a}catch(o){console.error(o)}finally{this.loadingList=!1}}},mounted(){this.fetchMediciones()}},M={class:"mt-4 max-w-md bg-white p-4 rounded shadow"},C={class:"mb-3"},E={class:"mb-3"},L={class:"mb-3"},V={class:"flex items-center justify-between"},j=["disabled"],S={key:0,class:"text-sm text-green-600"},W={class:"mt-8 bg-white p-4 rounded shadow"},B={key:0},D={key:1,class:"min-w-full bg-white shadow rounded"},F={class:"px-4 py-2"},N={class:"px-4 py-2"},P={class:"px-4 py-2"},U={class:"px-4 py-2"},A={class:"mt-8 bg-white p-4 rounded shadow"};function G(o,e,a,H,t,c){const p=f("WeightChart");return n(),r("div",null,[e[10]||(e[10]=s("h1",{class:"text-2xl font-bold"},"Registro de Mediciones",-1)),s("div",M,[s("form",{onSubmit:e[3]||(e[3]=x((...i)=>c.submitMedicion&&c.submitMedicion(...i),["prevent"]))},[s("div",C,[e[4]||(e[4]=s("label",{class:"block text-sm"},"Peso (kg)",-1)),d(s("input",{"onUpdate:modelValue":e[0]||(e[0]=i=>t.peso=i),type:"number",step:"0.1",class:"w-full px-3 py-2 border rounded"},null,512),[[u,t.peso,void 0,{number:!0}]])]),s("div",E,[e[5]||(e[5]=s("label",{class:"block text-sm"},"Altura (cm)",-1)),d(s("input",{"onUpdate:modelValue":e[1]||(e[1]=i=>t.altura=i),type:"number",step:"0.1",class:"w-full px-3 py-2 border rounded"},null,512),[[u,t.altura,void 0,{number:!0}]])]),s("div",L,[e[6]||(e[6]=s("label",{class:"block text-sm"},"Circunferencia de Cintura (cm)",-1)),d(s("input",{"onUpdate:modelValue":e[2]||(e[2]=i=>t.cintura=i),type:"number",step:"0.1",class:"w-full px-3 py-2 border rounded"},null,512),[[u,t.cintura,void 0,{number:!0}]])]),s("div",V,[s("button",{disabled:t.saving,class:"px-4 py-2 bg-green-600 text-white rounded"},l(t.saving?"Guardando...":"Guardar medición"),9,j),t.msg?(n(),r("div",S,l(t.msg),1)):y("",!0)])],32)]),s("div",W,[e[8]||(e[8]=s("h2",{class:"text-lg font-semibold mb-2"},"Historial de Mediciones",-1)),t.loadingList?(n(),r("div",B,"Cargando...")):(n(),r("table",D,[e[7]||(e[7]=s("thead",null,[s("tr",{class:"text-left"},[s("th",{class:"px-4 py-2"},"Fecha"),s("th",{class:"px-4 py-2"},"Peso (kg)"),s("th",{class:"px-4 py-2"},"Altura (cm)"),s("th",{class:"px-4 py-2"},"Cintura (cm)")])],-1)),s("tbody",null,[(n(!0),r(w,null,v(t.mediciones,i=>(n(),r("tr",{key:i.id},[s("td",F,l(new Date(i.creado_en).toLocaleString()),1),s("td",N,l(i.peso),1),s("td",P,l(i.altura),1),s("td",U,l(i.cintura),1)]))),128))])]))]),s("div",A,[e[9]||(e[9]=s("h2",{class:"text-lg font-semibold mb-2"},"Evolución de Peso",-1)),_(p,{measurements:t.mediciones},null,8,["measurements"])])])}const T=h(k,[["render",G]]);export{T as default};
