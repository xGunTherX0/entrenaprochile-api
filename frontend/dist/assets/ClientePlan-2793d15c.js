import{_ as p,a as c,o as s,c as r,b as n,t as l,d as u}from"./index-07731200.js";const h={name:"ClientePlan",data(){return{plan:null,loading:!0,error:null,solicitudId:null,planForbidden:!1}},methods:{async fetchPlanById(o){this.loading=!0,this.error=null,this.planForbidden=!1;try{const e=await c.get(`/api/planes/${o}`,{skipAuth:!0}),i=await e.json();if(e.ok)this.plan=i;else if(e.status===403)this.planForbidden=!0,this.error=i.error||"No autorizado para ver este plan.";else throw new Error(i.error||"Error fetching plan")}catch(e){this.error=e.message||String(e)}finally{this.loading=!1}},async cancelSolicitud(){if(this.solicitudId&&confirm("¿Seguro que quieres cancelar esta solicitud?"))try{const o=await c.del(`/api/solicitudes/${this.solicitudId}`),e=await o.json();if(!o.ok)throw new Error(e.error||"Error cancelando solicitud");try{alert("Solicitud cancelada")}catch{}this.$router.push("/cliente/planes")}catch(o){try{alert("No se pudo cancelar: "+(o.message||o))}catch{}}}},async mounted(){const o=this.$route.params.id;this.solicitudId=this.$route.query&&this.$route.query.solicitudId?this.$route.query.solicitudId:null,o&&await this.fetchPlanById(o)}},y={class:"p-6"},b={key:0},m={key:1,class:"text-red-600"},_={key:2,class:"bg-white p-4 rounded shadow"},f={key:0,class:"text-yellow-700 mb-4"},g={class:"text-xl font-bold"},v={class:"text-sm text-gray-600 mb-2"},k={class:"mb-4"},w={class:"border-t pt-4"},x=["innerHTML"],C={key:1,class:"text-sm text-gray-600"},I={key:1,class:"mt-4"};function S(o,e,i,E,t,d){return s(),r("div",y,[n("button",{onClick:e[0]||(e[0]=a=>o.$router.back()),class:"mb-4 px-3 py-2 bg-gray-200 rounded"},"Volver"),t.loading?(s(),r("div",b,"Cargando...")):t.error?(s(),r("div",m,l(t.error),1)):(s(),r("div",_,[t.planForbidden?(s(),r("div",f," Este plan no está público. No puedes ver su contenido completo. ")):u("",!0),n("h2",g,l(t.plan?t.plan.nombre:"Plan privado"),1),n("div",v,"Por: "+l(t.plan?t.plan.entrenador_nombre:"—"),1),n("p",k,l(t.plan?t.plan.descripcion:""),1),n("div",w,[e[3]||(e[3]=n("h3",{class:"font-semibold mb-2"},"Contenido del plan",-1)),t.plan&&!t.planForbidden?(s(),r("div",{key:0,innerHTML:t.plan.contenido},null,8,x)):(s(),r("div",C,"Contenido oculto"))]),t.solicitudId?(s(),r("div",I,[n("button",{onClick:e[1]||(e[1]=(...a)=>d.cancelSolicitud&&d.cancelSolicitud(...a)),class:"px-3 py-2 bg-red-600 text-white rounded mr-2"},"Cancelar plan"),n("button",{onClick:e[2]||(e[2]=a=>o.$router.push("/cliente/planes")),class:"px-3 py-2 bg-gray-200 rounded"},"Volver a solicitudes")])):u("",!0)]))])}const q=p(h,[["render",S]]);export{q as default};
