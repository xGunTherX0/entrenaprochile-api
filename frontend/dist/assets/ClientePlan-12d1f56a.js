import{_ as c,a,o as s,c as r,b as n,t as l,e as d}from"./index-34d007ee.js";const u={name:"ClientePlan",data(){return{plan:null,loading:!0,error:null,solicitudId:null,planForbidden:!1}},methods:{async fetchPlanById(o){this.loading=!0,this.error=null,this.planForbidden=!1;try{const e=await a.get(`/api/planes/${o}`),i=await e.json();if(e.ok)this.plan=i;else if(e.status===403)this.planForbidden=!0,this.error=i.error||"No autorizado para ver este plan.";else throw new Error(i.error||"Error fetching plan")}catch(e){this.error=e.message||String(e)}finally{this.loading=!1}},async cancelSolicitud(){if(this.solicitudId&&confirm("¿Seguro que quieres cancelar esta solicitud?"))try{const o=await a.del(`/api/solicitudes/${this.solicitudId}`),e=await o.json();if(!o.ok)throw new Error(e.error||"Error cancelando solicitud");try{alert("Solicitud cancelada")}catch{}this.$router.push("/cliente/planes")}catch(o){try{alert("No se pudo cancelar: "+(o.message||o))}catch{}}}},async mounted(){const o=this.$route.params.id;this.solicitudId=this.$route.query&&this.$route.query.solicitudId?this.$route.query.solicitudId:null,o&&await this.fetchPlanById(o)}},p={class:"p-6"},h={key:0},y={key:1,class:"text-red-600"},_={key:2,class:"bg-white p-4 rounded shadow"},m={key:0,class:"text-yellow-700 mb-4"},b={class:"text-xl font-bold"},f={class:"text-sm text-gray-600 mb-2"},g={class:"mb-4"},v={class:"border-t pt-4"},k=["innerHTML"],w={key:1,class:"text-sm text-gray-600"};function x(o,e,i,I,t,C){return s(),r("div",p,[n("button",{onClick:e[0]||(e[0]=E=>o.$router.back()),class:"mb-4 px-3 py-2 bg-gray-200 rounded"},"Volver"),t.loading?(s(),r("div",h,"Cargando...")):t.error?(s(),r("div",y,l(t.error),1)):(s(),r("div",_,[t.planForbidden?(s(),r("div",m," Este plan no está público. No puedes ver su contenido completo. ")):d("",!0),n("h2",b,l(t.plan?t.plan.nombre:"Plan privado"),1),n("div",f,"Por: "+l(t.plan?t.plan.entrenador_nombre:"—"),1),n("p",g,l(t.plan?t.plan.descripcion:""),1),n("div",v,[e[1]||(e[1]=n("h3",{class:"font-semibold mb-2"},"Contenido del plan",-1)),t.plan&&!t.planForbidden?(s(),r("div",{key:0,innerHTML:t.plan.contenido},null,8,k)):(s(),r("div",w,"Contenido oculto"))])]))])}const q=c(u,[["render",x]]);export{q as default};
